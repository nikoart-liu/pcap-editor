# PCAP编辑器

PCAP编辑器是一个用于查看和修改PCAP（网络数据包捕获）文件的图形化工具。它提供了直观的界面，让用户能够轻松地查看、分析和修改网络数据包。

## 功能特点

- 图形化界面，操作简单直观
- 支持查看和修改PCAP/PCAPNG文件
- 提供数据包预览和详细信息查看
- 支持修改MAC地址、IP地址、端口号、TTL和TOS值
- 支持修改TCP/UDP负载数据
- 提供数据包统计分析功能
- 实时处理进度显示
- 详细的操作日志记录
- 支持数据包右键快捷修改

## 主要功能模块

### 1. 文件操作
- 支持打开PCAP/PCAPNG文件
- 支持保存修改后的文件
- 自动生成输出文件名

### 2. MAC地址修改
- 修改源MAC地址
- 修改目标MAC地址

### 3. IP修改
- 修改源IP地址
- 修改目标IP地址
- 修改TTL值
- 修改TOS值

### 4. 端口修改
- 修改TCP/UDP源端口
- 修改TCP/UDP目标端口

### 5. Payload修改
- 支持指定偏移量和长度
- 支持十六进制数据输入
- 可选择是否启用Payload修改

### 6. 数据包预览
- 显示数据包列表（包含MAC地址、IP地址、协议等信息）
- 显示详细的数据包信息
- 支持十六进制和ASCII格式查看
- 支持右键快捷修改数据包字段

### 7. 统计分析
- MAC地址使用统计
- 协议分布统计
- IP地址使用统计
- 端口使用统计
- TTL值分布统计

## 使用方法

1. 打开程序
   - 双击运行PCAP编辑器可执行文件

2. 选择文件
   - 点击"浏览..."按钮选择输入PCAP文件
   - 程序会自动生成输出文件名，也可以手动指定

3. 修改设置
   - 在MAC选项卡中设置MAC地址相关修改
   - 在IP选项卡中设置IP相关修改
   - 在端口选项卡中设置端口相关修改
   - 在Payload修改选项卡中设置数据修改

4. 预览数据包
   - 切换到"数据包预览"选项卡
   - 点击"加载数据包预览"按钮
   - 在列表中选择数据包查看详情
   - 可以右键点击数据包进行快捷修改

5. 查看统计信息
   - 切换到"统计信息"选项卡
   - 点击"生成统计信息"按钮

6. 处理文件
   - 设置完成后点击"处理PCAP文件"按钮
   - 等待处理完成
   - 查看日志了解处理结果

## 输入格式说明

### MAC地址修改
- 源MAC：分别输入原始MAC和新MAC地址
- 目标MAC：分别输入原始MAC和新MAC地址
- 格式示例：`00:11:22:33:44:55` → `aa:bb:cc:dd:ee:ff`

### IP地址修改
- 源IP：分别输入原始IP和新IP地址
- 目标IP：分别输入原始IP和新IP地址
- 格式示例：`192.168.1.1` → `10.0.0.1`

### 端口修改
- 源端口：分别输入原始端口和新端口
- 目标端口：分别输入原始端口和新端口
- 格式示例：`80` → `8080`

### TTL和TOS修改
- TTL：分别输入原始TTL值和新TTL值
- TOS：分别输入原始TOS值和新TOS值
- 格式示例：`64` → `128`

### Payload数据
- 偏移量：数字，表示从数据包开始的偏移位置
- 长度：要修改的数据长度
- 新数据：十六进制格式，例如 `AABBCC`

## 右键菜单功能
在数据包预览表格中右键点击可以：
- 修改源MAC地址
- 修改目标MAC地址
- 修改源IP地址
- 修改目标IP地址

## 注意事项

1. 处理大文件时可能需要较长时间，请耐心等待
2. 建议在修改前备份原始文件
3. 确保有足够的磁盘空间保存修改后的文件
4. 修改后的文件会自动重新计算校验和
5. 在预览模式下修改的数据包需要点击"应用更改"按钮才会保存

## 打包
```bash
pip install pyinstaller
pyinstaller pcap_editor.spec
```

## 系统要求
- 操作系统：Windows/macOS/Linux
- Python 3.6或更高版本（如果从源码运行）
- 必要的Python包：
- PyQt5
- scapy
- pyinstaller（仅打包需要）

## 许可证
MIT License